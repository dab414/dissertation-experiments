mean(pilot$pSwitch)
m2 <- lm(error ~ pSwitchC, data = pilot)
## create centered term
pilot$pSwitchC <- pilot$pSwitch - .5
m2 <- lm(error ~ pSwitchC, data = pilot)
summary(m2)
m1 <- lm(rt ~ pSwitchC, data = pilot[pilot$error == 0,])
summary(m1)
m1$coefficients
m1$coefficients$`(Intercept)`
m1$coefficients['(Intercept']
m1$coefficients['(Intercept)']
m1$coefficients['(Intercept)']-2
m1$coefficients['(Intercept)'][0]
m1$coefficients['(Intercept)'][1]
pilot$rtProba <- with(pilot, m1$coefficients['Intercept'] + pSwitchC * m1$coefficients['pSwitchC'])
head(pilot)
pilot$rtProba <- with(pilot, m1$coefficients['(Intercept)'] + pSwitchC * m1$coefficients['pSwitchC'])
head(pilot)
pilot %>%
group_by(pSwitch) %>%
summarize(rtProba = mean(rtProba)) %>%
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(size = 2, color = 'black') +
geom_line(size = 2, color = 'black') +
geom_point(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt))
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'black') +
geom_line(size = 2, color = 'black')
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'black', alpha = .5) +
geom_line(size = 2, color = 'black')
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .5) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'black') +
geom_line(size = 2, color = 'black')
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red')
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_discrete(labels = .1:1)
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_discrete(breaks = seq(.1,1,.1), labels = seq(.1,1,.1))
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red')
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(.1,1,.1), labels = seq(.1,1,.1))
pilot %>%
mutate(pSwitchC = pSwitchC + .5) %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(.1,1,.1), labels = seq(.1,1,.1))
pilot %<>%
mutate(pSwitchC = pSwitchC + .5) %>%
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(.1,1,.1), labels = seq(.1,1,.1))
pilot %<>%
mutate(pSwitchC = pSwitchC + .5)
install.library(magrittr)
install.library('magrittr')
install.packages('magrittr')
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
q()
library(magrittr)
pilot %<>%
mutate(pSwitchC = pSwitchC + .5)
pilot <- read.csv('../data/dissertationPilot.csv')
library(tidyverse)
library(ez)
library(magrittr)
## create centered term
pilot$pSwitchC <- pilot$pSwitch - .5
m1 <- lm(rt ~ pSwitchC, data = pilot[pilot$error == 0,])
m2 <- lm(error ~ pSwitchC, data = pilot)
pilot %<>%
mutate(pSwitchC = pSwitchC + .5)
summary(pilot$pSwitchC)
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(.1,1,.1), labels = seq(.1,1,.1))
rm(list = ls())
library(tidyverse)
library(ez)
library(magrittr)
pilot <- read.csv('../data/dissertationPilot.csv')
### I'm going to get the R*2 for both relationships,
## and for error I think I'll run an ANOVA and do a follow-up comparison on the last two points
## create centered term
pilot$pSwitchC <- pilot$pSwitch - .5
m1 <- lm(rt ~ pSwitchC, data = pilot[pilot$error == 0,])
m2 <- lm(error ~ pSwitchC, data = pilot)
pilot$rtProba <- with(pilot, m1$coefficients['(Intercept)'] + pSwitchC * m1$coefficients['pSwitchC'])
pilot %<>%
mutate(pSwitchC = pSwitchC + .5)
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(.1,1,.1), labels = seq(.1,1,.1))
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(0,1,.1), labels = seq(0,1,.1))
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 2, color = 'red') +
geom_line(size = 2, color = 'red') +
scale_x_continuous(breaks = seq(0,1,.1), labels = seq(0,1,.1)) +
ylab('Response Time (ms)') +
xlab('Probability of Switching') +
theme_bw()
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 3, color = 'blue') +
geom_line(size = 2, color = 'blue') +
scale_x_continuous(breaks = seq(0,1,.1), labels = seq(0,1,.1)) +
ylab('Response Time (ms)') +
xlab('Probability of Switching') +
theme_bw()
sink(file = 'regressionResults.txt')
summary(m1)
summary(m2)
sink(NULL)
quickSum <- function(dv) {
pilot %>%
filter(error == 0) %>%
group_by(subject, pSwitch) %>%
summarize(dv1 = mean(dv)) %>%
group_by(pSwitch) %>%
summarize(dv = mean(dv1), se = sd(dv1)/sqrt(n()))
}
dvs <- c('rt', 'error')
for (i in dvs) {
quickSum(i)
}
warnings()
pilot %>%
filter(error == 0) %>%
group_by(subject, pSwitch) %>%
summarize(rt1 = mean(dv)) %>%
group_by(pSwitch) %>%
summarize(rt = mean(rt1), se = sd(rt1)/sqrt(n()))
pilot %>%
filter(error == 0) %>%
group_by(subject, pSwitch) %>%
summarize(rt1 = mean(rt)) %>%
group_by(pSwitch) %>%
summarize(rt = mean(rt1), se = sd(rt1)/sqrt(n()))
pilot %>%
group_by(subject, pSwitch) %>%
summarize(error1 = mean(error)) %>%
group_by(pSwitch) %>%
summarize(error = mean(error1), se = sd(error1)/sqrt(n()))
mRt <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
summary(mRt)
mRt
omniSsd <- mRt$ANOVA$SSd['pSwitch']
omniSsd
mRt$ANOVA$SSd['pSwitch']
mRt$ANOVA$SSd
mRt$ANOVA$SSd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
mRtFollow
omniDfd <- mRt$ANOVA$DFd[2]
omniDfn <- mRt$ANOVA$DFn[2]
p
msn <- ssn / omniDfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, omniDfn, omniDfd, lower.tail = FALSE)
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
msn <- ssn / omniDfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, omniDfn, omniDfd, lower.tail = FALSE)
p
Fcalc
## rt anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot[pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1 & pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
msn <- ssn / omniDfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, omniDfn, omniDfd, lower.tail = FALSE)
p
Fcalc
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
msn <- ssn / omniDfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, omniDfn, omniDfd, lower.tail = FALSE)
p
Fcalc
## rt anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot[pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1 & pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
dfn <- mRtFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
p
Fcalc
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
dfn <- mErrorFollow$ANOVA$DFn[2]
msn <- ssn /
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
dfn <- mErrorFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
p
Fcalc
print(paste('F(',dfn,' ', omniDfd,') = ', Fcalc, ', p = ', p))
print(paste('F(',dfn,', ', omniDfd,') = ', Fcalc, ', p = ', p, sep = ''))
print(paste('F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
## rt anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot[pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1 & pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
dfn <- mRtFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('RT: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
## error anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
dfn <- mErrorFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('Errors: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
print('This is a contrast between 0.9 and 1 levels of pSwitch for RT and errors from two separate ANOVAs\n')
print('This is a contrast between 0.9 and 1 levels of pSwitch for RT and errors from two separate ANOVAs')
## rt anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot[pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1 & pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
dfn <- mRtFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('RT: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
## error anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
dfn <- mErrorFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('Errors: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
sink(file = 'anovaResults.txt')
print('This is a contrast between 0.9 and 1 levels of pSwitch for RT and errors from two separate ANOVAs')
## rt anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot[pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1 & pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
dfn <- mRtFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('RT: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
## error anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
dfn <- mErrorFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('Errors: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
sink(NULL)
q()
library(tidyverse)
library(ez)
library(magrittr)
pilot <- read.csv('../data/dissertationPilot.csv')
### I'm going to get the R*2 for both relationships,
## and for error I think I'll run an ANOVA and do a follow-up comparison on the last two points
## create centered term
pilot$pSwitchC <- pilot$pSwitch - .5
m1 <- lm(rt ~ pSwitchC, data = pilot[pilot$error == 0,])
m2 <- lm(error ~ pSwitchC, data = pilot)
## save results
sink(file = 'regressionResults.txt')
summary(m1)
summary(m2)
sink(NULL)
pilot$rtProba <- with(pilot, m1$coefficients['(Intercept)'] + pSwitchC * m1$coefficients['pSwitchC'])
pilot %<>%
mutate(pSwitchC = pSwitchC + .5)
## just for fun
pilot %>%
group_by(pSwitchC) %>%
summarize(rtProba = mean(rtProba)) %>%
ggplot(aes(x = pSwitchC, y = rtProba)) +
geom_point(data = pilot, aes(x = pSwitchC, y = rt), alpha = .2) +
geom_jitter(data = pilot, aes(x = pSwitchC, y = rt)) +
geom_point(size = 3, color = 'blue') +
geom_line(size = 2, color = 'blue') +
scale_x_continuous(breaks = seq(0,1,.1), labels = seq(0,1,.1)) +
ylab('Response Time (ms)') +
xlab('Probability of Switching') +
theme_bw()
### ANOVA stuff
## summarize means first
sink(file='cellMeans.txt')
pilot %>%
filter(error == 0) %>%
group_by(subject, pSwitch) %>%
summarize(rt1 = mean(rt)) %>%
group_by(pSwitch) %>%
summarize(rt = mean(rt1), se = sd(rt1)/sqrt(n()))
pilot %>%
group_by(subject, pSwitch) %>%
summarize(error1 = mean(error)) %>%
group_by(pSwitch) %>%
summarize(error = mean(error1), se = sd(error1)/sqrt(n()))
sink(NULL)
sink(file = 'anovaResults.txt')
print('This is a contrast between 0.9 and 1 levels of pSwitch for RT and errors from two separate ANOVAs')
## rt anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mRt <- ezANOVA(data = pilot[pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
omniSsd <- mRt$ANOVA$SSd[2]
omniDfn <- mRt$ANOVA$DFn[2]
omniDfd <- mRt$ANOVA$DFd[2]
mRtFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1 & pilot$error == 0,], wid = subject, within = pSwitch, dv = rt, detailed = TRUE)
ssn <- mRtFollow$ANOVA$SSn[2]
dfn <- mRtFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('RT: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
## error anova
pilot$pSwitch <- as.factor(pilot$pSwitch)
mError <- ezANOVA(data = pilot, wid = subject, within = pSwitch, dv = error, detailed = TRUE)
omniSsd <- mError$ANOVA$SSd[2]
omniDfn <- mError$ANOVA$DFn[2]
omniDfd <- mError$ANOVA$DFd[2]
mErrorFollow <- ezANOVA(data = pilot[pilot$pSwitch == .9 | pilot$pSwitch == 1,], wid = subject, within = pSwitch, dv = error, detailed = TRUE)
ssn <- mErrorFollow$ANOVA$SSn[2]
dfn <- mErrorFollow$ANOVA$DFn[2]
msn <- ssn / dfn
msd <- omniSsd / omniDfd
Fcalc <- msn / msd
p <- pf(Fcalc, dfn, omniDfd, lower.tail = FALSE)
print(paste('Errors: F(',dfn,', ', omniDfd,') = ', round(Fcalc,2), ', p = ', round(p,2), sep = ''))
sink(NULL)
q()
